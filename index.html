<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Pop Secret Popcorn Shop</title>
  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
  <style>
    :root{ --brand:#232f3e; --accent:#ffa41c; --accent2:#ffd814; --price:#b12704; --bg:#f3f3f3; --card:#fff; --text:#111; --muted:#666; --border:#e3e6e6; --star:#f59e0b; --instock:#067d62; --lowstock:#b12704; --viewer:#007185; }
    *{box-sizing:border-box} body{font-family:Arial,Helvetica,sans-serif;background:var(--bg);color:var(--text);margin:0}
    header{background:var(--brand);color:#fff;padding:12px 16px;display:flex;align-items:center;gap:12px;position:sticky;top:0;z-index:10}
    .logo{font-weight:bold;font-size:18px;white-space:nowrap}
    .search{flex:1;display:flex;gap:8px;max-width:800px;margin:0 8px}
    .search input{flex:1;padding:8px 10px;border-radius:4px;border:1px solid #ccc}
    .cart{white-space:nowrap;font-size:16px}
    .container{max-width:1200px;margin:18px auto;padding:0 12px;display:grid;grid-template-columns: 1.15fr 1fr;gap:18px}
    .card{background:var(--card);border:1px solid var(--border);border-radius:8px;padding:18px;box-shadow:0 1px 2px rgba(0,0,0,.06)}
    .gallery-main{text-align:center}
    .gallery-main img{max-width:100%;border-radius:8px;border:1px solid #ddd}
    .thumbs{display:flex;gap:10px;margin-top:12px;flex-wrap:wrap;justify-content:center}
    .thumbs img{width:80px;height:80px;object-fit:cover;border:2px solid transparent;border-radius:6px;cursor:pointer}
    .thumbs img.active{border-color:#007185}
    .details h1{margin:.2em 0 .4em}
    .subtle{color:var(--muted);font-size:14px}
    .price{color:var(--price);font-size:22px;margin:.4em 0 .3em}
    .meta-row{display:flex;align-items:center;gap:12px;flex-wrap:wrap}
    .badge{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border-radius:999px;font-size:12px;font-weight:bold}
    .badge.in{background:#e8f5f1;color:var(--instock);border:1px solid #c7eee4}
    .badge.low{background:#fdecea;color:var(--lowstock);border:1px solid #facdca}
    .viewer{font-size:13px;color:var(--viewer)}
    .bullets{margin:.5em 0 1em;padding-left:18px}
    .buybox .row{display:flex;align-items:center;gap:10px;margin:8px 0}
    .qty input{width:56px;text-align:center;padding:6px;border:1px solid #ccc;border-radius:4px}
    .btn{border:none;border-radius:20px;padding:12px 16px;font-weight:bold;cursor:pointer;width:100%}
    .btn-cart{background:var(--accent)}
    .btn-buynow{background:var(--accent2);margin-top:8px}
    .btn:active{transform:translateY(1px)}
    .form label{display:block;margin-top:10px;font-size:14px}
    .form input,.form textarea{width:100%;padding:10px;border:1px solid #ccc;border-radius:6px;margin-top:6px;font-size:15px}
    .qrcode{text-align:center;margin-top:14px}
    .note{font-size:12px;color:#555;margin-top:8px}
    .ok{color:#067d62;text-align:center;margin-top:10px}
    .err{color:#b12704;text-align:center;margin-top:10px}
    .reviews{margin-top:18px}
    .review-item{border-top:1px solid var(--border);padding:12px 0}
    .stars{color:var(--star)}
    .review-head{display:flex;justify-content:space-between;align-items:center}
    .review-name{font-weight:bold}
    .review-date{color:var(--muted);font-size:12px}
    footer{padding:24px;text-align:center;color:#666}
    @media (max-width: 980px){.container{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <header>
    <div class="logo" id="t_brand">Pop Secret Shop</div>
    <div class="search"><input id="search" placeholder="Search"/></div>
    <div class="cart" id="t_cart">üõí Cart</div>
  </header>

  <main class="container">
    <section class="card">
      <div class="gallery-main">
        <img id="mainImg" src="https://i.ibb.co/9kvfpgzg/166578-0.jpg" alt="Pop Secret Popcorn"/>
      </div>
      <div class="thumbs" id="thumbs">
        <img class="active" src="https://i.ibb.co/9kvfpgzg/166578-0.jpg" alt="main">
        <img src="https://i.ibb.co/t57D3Tv/166579-0.jpg" alt="side1">
        <img src="https://i.ibb.co/Zz8BXHZ0/166580-0.jpg" alt="side2">
        <img src="https://i.ibb.co/SwB3Y16W/166581-0.jpg" alt="back">
      </div>

      <div class="details">
        <h1 id="t_name">Pop Secret Popcorn Movie Theater Butter 588g</h1>
        <div class="subtle" id="t_sku">Ships from Thailand | Sold by TopsOffer TH</div>
        <div class="price"><span id="t_price">Price</span>: <b><span id="price">1299</span> THB</b></div>
        <div class="meta-row">
          <span id="stockBadge" class="badge in">‚úî In stock</span>
          <span id="viewerNow" class="viewer">23 people are viewing this now</span>
        </div>
        <ul class="bullets" id="t_bullets">
          <li>Movie-theater butter aroma</li>
          <li>Large 588g pack</li>
          <li>Microwave in 2‚Äì3 minutes</li>
          <li>Perfect for movie nights & parties</li>
        </ul>
      </div>

      <div class="reviews">
        <h2 id="t_reviews_title">Customer reviews</h2>
        <div class="review-item">
          <div class="review-head">
            <div class="review-name">Beam</div>
            <div class="review-date">2025-08-01</div>
          </div>
          <div class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
          <p id="t_review_1">Smells just like the cinema! Perfect for Netflix nights.</p>
        </div>
        <div class="review-item">
          <div class="review-head">
            <div class="review-name">Nan</div>
            <div class="review-date">2025-07-28</div>
          </div>
          <div class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ</div>
          <p id="t_review_2">Richer butter flavor than other brands. Will repurchase!</p>
        </div>
      </div>
    </section>

    <aside class="card buybox">
      <div class="row qty">
        <label id="t_qty" for="quantity">Qty</label>
        <input id="quantity" type="number" min="1" value="1"/>
      </div>
      <div class="row">
        <div><b id="t_total">Total:</b></div>
        <div><b><span id="total">1299</span> THB</b></div>
      </div>
      <button class="btn btn-cart" id="btnAddCart">Add to Cart</button>
      <button class="btn btn-buynow" id="btnBuyNow">Buy Now</button>
      <form id="orderForm" class="form" style="margin-top:12px">
        <label for="fname" id="t_fullname">Full Name</label>
        <input id="fname" name="name" required placeholder="John Doe"/>
        <label for="phone" id="t_phone">Phone Number</label>
        <input id="phone" name="phone" required placeholder="08xxxxxxxx"/>
        <label for="addr" id="t_address">Shipping Address</label>
        <textarea id="addr" name="address" required placeholder="Address, District, Province, Postal code"></textarea>
        <button class="btn btn-cart" type="submit" id="t_pay">Pay with PromptPay</button>
        <div class="note" id="t_note">A PromptPay QR will be generated for your exact amount.</div>
      </form>
      <div id="qrcode" class="qrcode"></div>
      <div id="msg" class="ok" style="display:none;"></div>
      <div id="err" class="err" style="display:none;"></div>
    </aside>
  </main>

  <footer>¬© 2025 TopsOffer Thailand</footer>

  <script>
    const UNIT_PRICE = 1299;
    const PROMPTPAY_MOBILE = "0866292379";
    const PROMPTPAY_NATIONAL_ID = "5110100025854";
    const PROMPTPAY_USE = "mobile";
    const EMAIL_TO = "officialvoucher@gmail.com";

    let INVENTORY = 24;
    let VIEWERS = Math.floor(Math.random()*10) + 18;

    const i18n = {
      th:{brand:"‡∏£‡πâ‡∏≤‡∏ô Pop Secret",cart:"‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤",name:"‡∏Ç‡πâ‡∏≤‡∏ß‡πÇ‡∏û‡∏î‡∏≠‡∏ö‡πÄ‡∏ô‡∏¢ Pop Secret 588g",sku:"‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡∏à‡∏≤‡∏Å‡πÑ‡∏ó‡∏¢ | ‡∏Ç‡∏≤‡∏¢‡πÇ‡∏î‡∏¢ TopsOffer TH",price:"‡∏£‡∏≤‡∏Ñ‡∏≤",
          bullets:["‡∏Å‡∏•‡∏¥‡πà‡∏ô‡πÄ‡∏ô‡∏¢‡∏´‡∏≠‡∏°‡πÅ‡∏ö‡∏ö‡πÇ‡∏£‡∏á‡∏´‡∏ô‡∏±‡∏á","‡πÅ‡∏û‡πá‡∏Ñ‡πÉ‡∏´‡∏ç‡πà 588g","‡∏≠‡∏∏‡πà‡∏ô‡πÑ‡∏°‡πÇ‡∏Ñ‡∏£‡πÄ‡∏ß‡∏ü 2‚Äì3 ‡∏ô‡∏≤‡∏ó‡∏µ","‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏Ñ‡∏∑‡∏ô‡∏î‡∏π‡∏´‡∏ô‡∏±‡∏á & ‡∏õ‡∏≤‡∏£‡πå‡∏ï‡∏µ‡πâ"],
          reviews_title:"‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡∏à‡∏≤‡∏Å‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤",review_1:"‡∏´‡∏≠‡∏°‡πÄ‡∏ô‡∏¢‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÉ‡∏ô‡πÇ‡∏£‡∏á‡∏´‡∏ô‡∏±‡∏á‡πÄ‡∏•‡∏¢! ‡∏Ñ‡∏∑‡∏ô‡∏î‡∏π Netflix ‡∏Ñ‡∏∑‡∏≠‡∏î‡∏µ‡∏°‡∏≤‡∏Å",review_2:"‡πÄ‡∏ô‡∏¢‡πÄ‡∏Ç‡πâ‡∏°‡∏Å‡∏ß‡πà‡∏≤‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠‡∏≠‡∏∑‡πà‡∏ô ‡∏ã‡∏∑‡πâ‡∏≠‡∏ã‡πâ‡∏≥‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô!",
          qty:"‡∏à‡∏≥‡∏ô‡∏ß‡∏ô",total:"‡∏£‡∏ß‡∏°",fullname:"‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•",phone:"‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£",address:"‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏±‡∏î‡∏™‡πà‡∏á",pay:"‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏ú‡πà‡∏≤‡∏ô PromptPay",
          note:"‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏¥‡∏ß‡∏≠‡∏≤‡∏£‡πå PromptPay ‡∏ï‡∏≤‡∏°‡∏¢‡∏≠‡∏î‡∏ä‡∏≥‡∏£‡∏∞‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì",ok:"‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!",err:"‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡πà‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÑ‡∏î‡πâ ‡πÇ‡∏õ‡∏£‡∏î‡∏•‡∏≠‡∏á‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á.",
          addcart:"‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤",buynow:"‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏•‡∏¢",instock:"‚úî ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡πà‡∏á",lowstock:"‚ö† ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏ô‡πâ‡∏≠‡∏¢",viewing:(n)=> `${n} ‡∏Ñ‡∏ô‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏π‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ`},
      en:{brand:"Pop Secret Shop",cart:"üõí Cart",name:"Pop Secret Popcorn Movie Theater Butter 588g",sku:"Ships from Thailand | Sold by TopsOffer TH",price:"Price",
          bullets:["Movie-theater butter aroma","Large 588g pack","Microwave in 2‚Äì3 minutes","Perfect for movie nights & parties"],
          reviews_title:"Customer reviews",review_1:"Smells just like the cinema! Perfect for Netflix nights.",review_2:"Richer butter flavor than other brands. Will repurchase!",
          qty:"Qty",total:"Total",fullname:"Full Name",phone:"Phone Number",address:"Shipping Address",pay:"Pay with PromptPay",
          note:"A PromptPay QR will be generated for your exact amount.",ok:"Order sent successfully!",err:"Failed to send email. Please try again.",
          addcart:"Add to Cart",buynow:"Buy Now",instock:"‚úî In stock",lowstock:"‚ö† Low stock",viewing:(n)=> `${n} people are viewing this now`}
    };
    const lang = (navigator.language||'en').toLowerCase().startsWith('th') ? 'th' : 'en';
    const t = i18n[lang]; document.documentElement.lang = lang === 'th' ? 'th' : 'en';

    function applyText(){
      document.getElementById('t_brand').textContent = t.brand;
      document.getElementById('t_cart').textContent = t.cart;
      document.getElementById('t_name').textContent = t.name;
      document.getElementById('t_sku').textContent = t.sku;
      document.getElementById('t_price').textContent = t.price;
      const bl = document.getElementById('t_bullets'); bl.innerHTML = '';
      t.bullets.forEach(x=>{const li=document.createElement('li');li.textContent=x;bl.appendChild(li);});
      document.getElementById('t_reviews_title').textContent = t.reviews_title;
      document.getElementById('t_review_1').textContent = t.review_1;
      document.getElementById('t_review_2').textContent = t.review_2;
      document.getElementById('t_qty').textContent = t.qty;
      document.getElementById('t_total').textContent = t.total;
      document.getElementById('t_fullname').textContent = t.fullname;
      document.getElementById('t_phone').textContent = t.phone;
      document.getElementById('t_address').textContent = t.address;
      document.getElementById('t_pay').textContent = t.pay;
      document.getElementById('t_note').textContent = t.note;
      document.getElementById('btnAddCart').textContent = t.addcart;
      document.getElementById('btnBuyNow').textContent = t.buynow;
      updateStockBadge(); updateViewer();
      document.getElementById('fname').placeholder = lang==='th' ? '‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•' : 'John Doe';
      document.getElementById('phone').placeholder = lang==='th' ? '08xxxxxxxx' : '08xxxxxxxx';
      document.getElementById('addr').placeholder  = lang==='th' ? '‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà, ‡πÄ‡∏Ç‡∏ï/‡∏≠‡∏≥‡πÄ‡∏†‡∏≠, ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î, ‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå' : 'Address, District, Province, Postal code';
    }
    applyText();

    const mainImg = document.getElementById('mainImg');
    document.getElementById('thumbs').addEventListener('click', (e)=>{
      if(e.target.tagName.toLowerCase() === 'img'){
        [...document.querySelectorAll('.thumbs img')].forEach(i=>i.classList.remove('active'));
        e.target.classList.add('active');
        mainImg.src = e.target.src;
      }
    });

    const qtyInput = document.getElementById('quantity'); const totalEl = document.getElementById('total');
    function updateTotal(){ const qty = Math.max(1, parseInt(qtyInput.value||'1')); qtyInput.value = qty; totalEl.textContent = (qty * 1299).toString(); }
    qtyInput.addEventListener('input', updateTotal); qtyInput.addEventListener('change', updateTotal); updateTotal();

    function updateStockBadge(){
      const el = document.getElementById('stockBadge');
      const cls = (INVENTORY <= 10) ? 'badge low' : 'badge in';
      el.className = cls;
      el.textContent = (INVENTORY <= 10) ? `${t.lowstock} (${INVENTORY})` : `${t.instock} (${INVENTORY})`;
    }
    function updateViewer(){ document.getElementById('viewerNow').textContent = t.viewing(VIEWERS); }
    (function jitter(){ const ms = (Math.random()*6000)+6000; setTimeout(()=>{ const d = Math.floor(Math.random()*5)-2; VIEWERS = Math.min(48, Math.max(8, VIEWERS + d)); updateViewer(); jitter(); }, ms); })();

    document.getElementById('btnAddCart').addEventListener('click', ()=>{
      const cur = Math.max(1, parseInt(qtyInput.value||'1')); qtyInput.value = cur + 1; updateTotal();
      document.getElementById('orderForm').scrollIntoView({behavior:'smooth'});
    });
    document.getElementById('btnBuyNow').addEventListener('click', ()=>{
      document.getElementById('orderForm').reportValidity(); if(document.getElementById('orderForm').checkValidity()){ submitOrder(); }
    });

    document.getElementById('orderForm').addEventListener('submit', (e)=>{ e.preventDefault(); submitOrder(); });

    async function submitOrder(){
      const qty = Math.max(1, parseInt(qtyInput.value||'1'));
      if(qty > INVENTORY){ alert(lang==='th' ? '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠' : 'Quantity exceeds available stock'); return; }
      const total = qty * 1299;
      const name = document.getElementById('fname').value.trim();
      const phone = document.getElementById('phone').value.trim();
      const addr = document.getElementById('addr').value.trim();
      if(!name || !phone || !addr){ return; }

      INVENTORY -= qty; updateStockBadge();

      const account = (PROMPTPAY_USE === 'nid') ? PROMPTPAY_NATIONAL_ID : PROMPTPAY_MOBILE;
      const payload = buildPromptPayPayload(account, total);
      const qrel = document.getElementById('qrcode'); qrel.innerHTML = '';
      await new Promise((resolve,reject)=>{ QRCode.toCanvas(document.createElement('canvas'), payload, (err, canvas)=>{ if(err){ reject(err);return;} qrel.appendChild(canvas); resolve(); }); });

      try{
        emailjs.init("YOUR_USER_ID");
        await emailjs.send("YOUR_SERVICE_ID","YOUR_TEMPLATE_ID",{ to_email: EMAIL_TO, name, phone, address: addr, quantity: qty, total, lang });
        const ok = document.getElementById('msg'); ok.textContent = t.ok; ok.style.display = 'block';
        const er = document.getElementById('err'); er.style.display = 'none';
      }catch(err){
        const er = document.getElementById('err'); er.textContent = t.err; er.style.display = 'block';
        const ok = document.getElementById('msg'); ok.style.display = 'none';
      }
    }

    function tlv(id, value){ const len = value.length; const lenStr = len.toString().padStart(2,'0'); return id + lenStr + value; }
    function buildPromptPayPayload(acc, amount){
      const isNatId = /^\d{13}$/.test(acc); const isPhone = /^0\d{9}$/.test(acc);
      let proxy = ''; if(isPhone){ proxy = '66' + acc.substring(1); } else if(isNatId){ proxy = acc; } else { throw new Error('Invalid PromptPay ID'); }
      const gui = 'A000000677010111'; const mai = tlv('00', gui) + tlv(isPhone ? '01':'02', proxy); const maiAll = tlv('29', mai);
      const payload = tlv('00','01') + tlv('01','11') + maiAll + tlv('52','0000') + tlv('53','764') + tlv('54', amount.toFixed(2)) + tlv('58','TH') + tlv('59','-') + tlv('60','Bangkok') + '6304';
      const crc = crc16(payload).toUpperCase(); return payload + crc;
    }
    function crc16(str){ let crc = 0xFFFF; for(let i=0;i<str.length;i++){ crc ^= str.charCodeAt(i) << 8; for(let j=0;j<8;j++){ crc = (crc & 0x8000) ? ((crc<<1) ^ 0x1021) : (crc<<1); crc &= 0xFFFF; } } return crc.toString(16).toUpperCase().padStart(4,'0'); }
  </script>
</body>
</html>
